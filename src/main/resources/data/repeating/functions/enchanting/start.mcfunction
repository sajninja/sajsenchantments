execute as @p[tag=repeating_enchanter] store result score @s repeating_xp run data get entity @s XpLevel 1

execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/3] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=repeating:enchanting/levels/3,distance=..0.5] run function repeating:enchanting/level_4
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/2] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=repeating:enchanting/levels/2,distance=..0.5] run function repeating:enchanting/level_3
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/1] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=repeating:enchanting/levels/1,distance=..0.5] run function repeating:enchanting/level_2

execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/4] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=repeating:enchanting/unenchanted,distance=..0.5] run function repeating:enchanting/level_4
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/3] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=repeating:enchanting/unenchanted,distance=..0.5] run function repeating:enchanting/level_3
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/2] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=repeating:enchanting/unenchanted,distance=..0.5] run function repeating:enchanting/level_2
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/1] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=repeating:enchanting/unenchanted,distance=..0.5] run function repeating:enchanting/level_1

execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/3] at @e[type=item,predicate=repeating:enchanting/is_book,predicate=repeating:enchanting/levels/3,distance=0.01..0.5] run function repeating:enchanting/level_4
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/2] at @e[type=item,predicate=repeating:enchanting/is_book,predicate=repeating:enchanting/levels/2,distance=0.01..0.5] run function repeating:enchanting/level_3
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/1] at @e[type=item,predicate=repeating:enchanting/is_book,predicate=repeating:enchanting/levels/1,distance=0.01..0.5] run function repeating:enchanting/level_2

execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/4] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,distance=..0.5] run function repeating:enchanting/level_4
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/3] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=!repeating:enchanting/levels/4,distance=..0.5] run function repeating:enchanting/level_3
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/2] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=!repeating:enchanting/levels/3,predicate=!repeating:enchanting/levels/4,distance=..0.5] run function repeating:enchanting/level_2
execute if entity @p[tag=repeating_enchanter,scores={repeating_xp=30..}] if entity @s[predicate=repeating:enchanting/levels/1] at @e[type=item,predicate=repeating:enchanting/is_enchantable_crossbow,predicate=!repeating:enchanting/levels/2,predicate=!repeating:enchanting/levels/3,predicate=!repeating:enchanting/levels/4,distance=..0.5] run function repeating:enchanting/level_1